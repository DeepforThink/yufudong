---
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import { SITE } from "@/config";

const friends = [
  {
    name: "Kinnari Blog",
    url: "https://kinnari-blog.vercel.app/",
    description: "梦想是成为一只 fumo",
    avatar: "https://avatars.githubusercontent.com/u/141706972?v=4"
  },
  {
    name: "Tendourisu's Site",
    url: "https://tendourisu.github.io/",
    description: "邦邦咔邦！野生的TendouRisu!",
    avatar: "https://avatars.githubusercontent.com/u/161988620?v=4"
  }
    // {
    //   name: "朋友的博客",
    //   url: "https://friend-blog.com",
    //   description: "简短的介绍或印象",
    //   avatar: "https://friend-avatar.jpg"
    // }
];
---

<Layout title={`friends | ${SITE.title}`}>
  <Header />
  
  <main id="main-content" class="mx-auto w-full max-w-app px-4 pb-12 pt-8">
    <!-- 页面标题 -->
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-skin-accent mb-4">友链</h1>
      <p class="text-lg text-skin-base opacity-80">
        这是我的朋友们！
      </p>
    </div>

    <!-- 友链卡片网格 -->
    {friends.length > 0 ? (
      <div class="grid gap-8 sm:grid-cols-1 lg:grid-cols-2 mb-12">
        {friends.map(friend => (
          <div class="group relative">
            <a 
              href={friend.url} 
              target="_blank" 
              rel="noopener noreferrer"
              class="block h-full"
            >
              <div class="h-full border border-skin-line rounded-lg p-8 bg-skin-card hover:shadow-lg hover:scale-105 transition-all duration-300">
                <!-- 头像和名称 -->
                <div class="flex items-center mb-6">
                  <img 
                    src={friend.avatar} 
                    alt={friend.name}
                    class="w-16 h-16 rounded-full border-2 border-skin-accent mr-6 group-hover:border-opacity-80"
                    onerror="this.src='https://via.placeholder.com/64/666/fff?text=A'"
                  />
                  <div>
                    <h3 class="text-xl font-semibold text-skin-accent group-hover:text-opacity-80 mb-2">
                      {friend.name}
                    </h3>
                    <div class="text-base text-skin-base opacity-60">
                      {new URL(friend.url).hostname}
                    </div>
                  </div>
                </div>
                
                <!-- 描述 -->
                <p class="text-skin-base text-base leading-relaxed line-clamp-3">
                  {friend.description}
                </p>
                
                <!-- 悬停效果指示器 -->
                <div class="absolute top-6 right-6 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                  <svg class="w-6 h-6 text-skin-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                  </svg>
                </div>
              </div>
            </a>
          </div>
        ))}
      </div>
    ) : (
      <div class="text-center mb-12 py-12">
        <div class="text-6xl mb-4">🌱</div>
        <p class="text-lg text-skin-base opacity-70 italic">
          这里还比较空旷，等待遇见更多有趣的灵魂...
        </p>
      </div>
    )}

    <!-- 分隔线 -->
    <hr class="border-skin-line mb-12" />

    <!-- 想要交换友链 -->
    <div class="bg-skin-card border border-skin-line rounded-lg p-8 mb-8">
      <h2 class="text-2xl font-bold text-skin-accent mb-4 text-center">想要交换友链？</h2>
      <p class="text-skin-base text-center mb-6 leading-relaxed">
        如果你也在用文字记录生活和思考，欢迎通过邮件联系我。
      </p>
    </div>

    <!-- 关于友链 -->
    <div class="bg-skin-card border border-skin-line rounded-lg p-8 mb-12">
      <h2 class="text-2xl font-bold text-skin-accent mb-4 text-center">关于友链</h2>
      <p class="text-skin-base text-center italic leading-relaxed">
        "好久不见"是我一篇博客的开头，也是我想对每一位路过的朋友说的话。
      </p>
    </div>

    <!-- 评论区域 -->
    <div class="bg-skin-card border border-skin-line rounded-lg p-8">
      <h2 class="text-2xl font-bold text-skin-accent mb-6 text-center">💬 留言评论</h2>
      <p class="text-skin-base text-center mb-8 opacity-80">
        欢迎在这里留下您的想法和建议，或者申请友链交换！
      </p>
      
      <!-- 评论表单 -->
      <div class="max-w-2xl mx-auto">
        <form class="space-y-6" id="comment-form">
          <!-- 基本信息 -->
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
              <label for="name" class="block text-sm font-medium text-skin-base mb-2">
                昵称 <span class="text-red-500">*</span>
              </label>
              <input 
                type="text" 
                id="name" 
                name="name"
                required
                class="w-full px-4 py-3 border border-skin-line rounded-lg bg-skin-card text-skin-base focus:outline-none focus:ring-2 focus:ring-skin-accent focus:border-transparent"
                placeholder="请输入您的昵称"
              />
            </div>
            <div>
              <label for="email" class="block text-sm font-medium text-skin-base mb-2">
                邮箱 <span class="text-red-500">*</span>
              </label>
              <input 
                type="email" 
                id="email" 
                name="email"
                required
                class="w-full px-4 py-3 border border-skin-line rounded-lg bg-skin-card text-skin-base focus:outline-none focus:ring-2 focus:ring-skin-accent focus:border-transparent"
                placeholder="您的邮箱地址"
              />
            </div>
          </div>
          
          <!-- 网站链接（可选） -->
          <div>
            <label for="website" class="block text-sm font-medium text-skin-base mb-2">
              个人网站（可选）
            </label>
            <input 
              type="url" 
              id="website" 
              name="website"
              class="w-full px-4 py-3 border border-skin-line rounded-lg bg-skin-card text-skin-base focus:outline-none focus:ring-2 focus:ring-skin-accent focus:border-transparent"
              placeholder="https://your-website.com"
            />
          </div>
          
          <!-- 评论内容 -->
          <div>
            <label for="message" class="block text-sm font-medium text-skin-base mb-2">
              留言内容 <span class="text-red-500">*</span>
            </label>
            <textarea 
              id="message" 
              name="message"
              required
              rows="5"
              class="w-full px-4 py-3 border border-skin-line rounded-lg bg-skin-card text-skin-base focus:outline-none focus:ring-2 focus:ring-skin-accent focus:border-transparent resize-vertical"
              placeholder="写下您想说的话..."
            ></textarea>
          </div>
          
          <!-- 提交按钮 -->
          <div class="text-center">
            <button 
              type="submit"
              class="inline-flex items-center px-8 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-skin-accent hover:bg-opacity-80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-skin-accent transition-all duration-300"
            >
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
              </svg>
              发送留言
            </button>
          </div>
        </form>
        
        <!-- 提示信息 -->
        <div class="mt-6 text-center">
          <p class="text-sm text-skin-base opacity-70">
            💡 提示：评论将通过邮件发送给我，我会尽快回复您
          </p>
        </div>
      </div>
    </div>
  </main>

  <Footer />
</Layout>

<script>
  // 评论表单处理
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('comment-form') as HTMLFormElement;
    
    if (form) {
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // 获取表单数据
        const formData = new FormData(form);
        const name = formData.get('name') as string;
        const email = formData.get('email') as string;
        const website = formData.get('website') as string;
        const message = formData.get('message') as string;
        
        // 构建邮件内容
        const subject = encodeURIComponent(`友链页面留言 - 来自 ${name}`);
        const body = encodeURIComponent(`
昵称: ${name}
邮箱: ${email}
网站: ${website || '未填写'}

留言内容:
${message}

---
此留言来自您的博客友链页面
        `);
        
        // 使用 mailto 链接
        const mailtoLink = `mailto:yf_dong@mail.nankai.edu.cn?subject=${subject}&body=${body}`;
        
        // 打开邮件客户端
        window.location.href = mailtoLink;
        
        // 显示提示信息
        alert('正在打开您的邮件客户端，请发送邮件完成留言！');
      });
    }
  });
</script>

<style>
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
